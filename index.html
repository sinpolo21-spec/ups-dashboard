<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enterprise UPS Management System - Advanced Analytics Platform</title>
    
    <!-- CDN Links -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.min.js"></script>
    
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --text-primary: #ecf0f1;
            --text-secondary: #bdc3c7;
            --accent-blue: #5dade2;
            --accent-green: #58d68d;
            --accent-purple: #bb8fce;
            --accent-orange: #f7dc6f;
            --danger: #ec7063;
            --warning: #f39c12;
            --success: #27ae60;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: radial-gradient(ellipse at top, #1a1a2e, #16213e), 
                        linear-gradient(135deg, #0f0f23, #1a1a2e);
            color: var(--text-primary);
            overflow-x: hidden;
            min-height: 100vh;
            font-weight: 400;
            line-height: 1.6;
        }

        /* Loading System */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f0f23, #1a1a2e);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 20000;
        }

        .loading-logo {
            width: 120px;
            height: 120px;
            border: 4px solid transparent;
            border-top: 4px solid #667eea;
            border-right: 4px solid #764ba2;
            border-bottom: 4px solid #f093fb;
            border-radius: 50%;
            animation: complexSpin 2s linear infinite;
            margin-bottom: 30px;
        }

        @keyframes complexSpin {
            0% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.1); }
            100% { transform: rotate(360deg) scale(1); }
        }

        .loading-text {
            color: var(--accent-blue);
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 20px;
            text-align: center;
        }

        .loading-progress {
            width: 300px;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .loading-progress-bar {
            width: 0%;
            height: 100%;
            background: var(--primary-gradient);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .loading-status {
            color: var(--text-secondary);
            font-size: 14px;
            text-align: center;
        }

        /* Login Portal */
        .login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.95), rgba(26, 26, 46, 0.95));
            backdrop-filter: blur(20px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }

        .login-container {
            background: var(--glass-bg);
            backdrop-filter: blur(25px);
            border: 2px solid var(--glass-border);
            border-radius: 28px;
            padding: 60px;
            text-align: center;
            box-shadow: 0 30px 80px rgba(0,0,0,0.6);
            min-width: 520px;
            animation: loginGlide 0.8s cubic-bezier(0.23, 1, 0.32, 1);
        }

        @keyframes loginGlide {
            from { opacity: 0; transform: translateY(-60px) scale(0.9); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .login-title {
            font-size: 3.2rem;
            margin-bottom: 20px;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 800;
            letter-spacing: -2px;
        }

        .login-subtitle {
            color: var(--text-secondary);
            margin-bottom: 40px;
            font-size: 1.3rem;
            font-weight: 300;
        }

        .login-input {
            width: 100%;
            padding: 22px 28px;
            margin-bottom: 28px;
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 18px;
            background: rgba(255,255,255,0.05);
            color: var(--text-primary);
            font-size: 17px;
            backdrop-filter: blur(10px);
            transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
            font-weight: 500;
        }

        .login-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 40px rgba(102, 126, 234, 0.5);
            transform: scale(1.02);
            background: rgba(255,255,255,0.1);
        }

        .login-btn {
            width: 100%;
            padding: 22px;
            border: none;
            border-radius: 18px;
            background: var(--primary-gradient);
            color: white;
            font-size: 19px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
            text-transform: uppercase;
            letter-spacing: 1.5px;
        }

        .login-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 60px rgba(102, 126, 234, 0.6);
        }

        .security-notice {
            margin-top: 25px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .login-error {
            color: var(--danger);
            margin-top: 15px;
            font-weight: 600;
        }

        /* Header */
        .header {
            background: var(--primary-gradient);
            color: white;
            padding: 50px 30px;
            text-align: center;
            box-shadow: 0 15px 50px rgba(0,0,0,0.5);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: shimmer 4s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .header h1 {
            font-size: 4rem;
            margin-bottom: 20px;
            text-shadow: 2px 2px 12px rgba(0,0,0,0.4);
            font-weight: 900;
            letter-spacing: -3px;
        }

        .header p {
            font-size: 1.5rem;
            opacity: 0.95;
            font-weight: 300;
            letter-spacing: 1px;
        }

        /* Container */
        .container {
            max-width: 2000px;
            margin: 0 auto;
            padding: 40px;
        }

        /* Grid System */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 40px;
            margin-bottom: 40px;
        }

        .main-panel, .side-panel {
            display: flex;
            flex-direction: column;
            gap: 40px;
        }

        /* Panel System */
        .panel {
            background: var(--glass-bg);
            backdrop-filter: blur(25px);
            border: 2px solid var(--glass-border);
            border-radius: 28px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
            position: relative;
            overflow: hidden;
        }

        .panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--primary-gradient);
            border-radius: 28px 28px 0 0;
        }

        .panel:hover {
            transform: translateY(-8px);
            box-shadow: 0 30px 80px rgba(0,0,0,0.3);
            border-color: rgba(255, 255, 255, 0.2);
        }

        /* Control Panel */
        .control-panel {
            background: linear-gradient(135deg, rgba(39, 174, 96, 0.2), rgba(46, 204, 113, 0.1));
            border-color: rgba(39, 174, 96, 0.3);
        }

        .control-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 25px;
            margin-bottom: 35px;
        }

        .btn {
            padding: 20px 35px;
            border: none;
            border-radius: 18px;
            cursor: pointer;
            font-weight: 700;
            font-size: 16px;
            transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1.2px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .btn:hover {
            transform: translateY(-6px);
            box-shadow: 0 20px 50px rgba(0,0,0,0.4);
        }

        .btn-start { 
            background: linear-gradient(135deg, #27ae60, #2ecc71, #58d68d); 
            color: white;
        }
        .btn-stop { 
            background: linear-gradient(135deg, #e74c3c, #c0392b, #ec7063); 
            color: white;
        }
        .btn-export { 
            background: linear-gradient(135deg, #3498db, #2980b9, #5dade2); 
            color: white;
        }
        .btn-ai { 
            background: linear-gradient(135deg, #9b59b6, #8e44ad, #bb8fce); 
            color: white;
        }
        .btn-simulate { 
            background: linear-gradient(135deg, #f39c12, #e67e22, #f7dc6f); 
            color: white;
        }
        .btn-analyze { 
            background: linear-gradient(135deg, #16a085, #1abc9c, #7fb3d3); 
            color: white;
        }

        /* Status System */
        .status {
            font-size: 24px;
            font-weight: 700;
            color: var(--success);
            display: flex;
            align-items: center;
            gap: 25px;
            padding: 30px;
            background: rgba(39, 174, 96, 0.15);
            border-radius: 18px;
            border-left: 6px solid var(--success);
            box-shadow: 0 10px 30px rgba(39, 174, 96, 0.2);
        }

        .status-indicator {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--success);
            animation: advancedPulse 2s infinite;
            box-shadow: 0 0 25px var(--success);
        }

        @keyframes advancedPulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.3); box-shadow: 0 0 40px var(--success); }
        }

        /* Metrics Grid */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .metric-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.15), rgba(255,255,255,0.05));
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 24px;
            padding: 35px;
            text-align: center;
            transition: all 0.6s cubic-bezier(0.23, 1, 0.32, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: var(--primary-gradient);
            background-size: 400% 100%;
            animation: gradientFlow 5s ease infinite;
        }

        @keyframes gradientFlow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .metric-card:hover {
            transform: translateY(-12px) scale(1.05);
            box-shadow: 0 25px 60px rgba(0,0,0,0.4);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .metric-title {
            font-size: 15px;
            color: var(--text-secondary);
            margin-bottom: 18px;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: 700;
        }

        .metric-value {
            font-size: 3.5rem;
            font-weight: 900;
            margin-bottom: 12px;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.1;
        }

        .metric-subtitle {
            font-size: 13px;
            color: var(--text-secondary);
            font-weight: 500;
            opacity: 0.8;
        }

        /* Charts Container */
        .charts-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-bottom: 40px;
        }

        .chart-panel {
            background: var(--glass-bg);
            backdrop-filter: blur(25px);
            border: 2px solid var(--glass-border);
            border-radius: 28px;
            padding: 35px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
        }

        .chart-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--primary-gradient);
        }

        .chart-title {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 12px;
            color: var(--text-primary);
            letter-spacing: 0.5px;
        }

        .chart-subtitle {
            font-size: 15px;
            color: var(--text-secondary);
            margin-bottom: 30px;
            font-weight: 500;
        }

        .chart-container {
            position: relative;
            height: 350px;
            width: 100%;
        }

        /* 3D Container */
        .topology-3d {
            height: 450px;
            background: linear-gradient(135deg, rgba(0,0,0,0.6), rgba(0,0,0,0.3));
            border-radius: 24px;
            position: relative;
            overflow: hidden;
            border: 2px solid var(--glass-border);
            box-shadow: inset 0 4px 25px rgba(0,0,0,0.5);
        }

        /* AI Panel */
        .ai-panel {
            background: linear-gradient(135deg, rgba(155, 89, 182, 0.25), rgba(142, 68, 173, 0.15));
            border: 2px solid rgba(155, 89, 182, 0.4);
        }

        .ai-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 30px;
            color: var(--accent-purple);
            letter-spacing: 0.5px;
        }

        .ai-metrics {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }

        .ai-metric {
            background: rgba(155, 89, 182, 0.2);
            padding: 25px;
            border-radius: 18px;
            text-align: center;
            border: 2px solid rgba(155, 89, 182, 0.4);
            transition: all 0.3s ease;
        }

        .ai-metric:hover {
            transform: scale(1.05);
            border-color: rgba(155, 89, 182, 0.6);
        }

        .ai-metric-label {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .ai-metric-value {
            font-size: 22px;
            font-weight: 800;
            color: var(--accent-purple);
        }

        /* Financial Panel */
        .financial-panel {
            background: linear-gradient(135deg, rgba(39, 174, 96, 0.2), rgba(46, 204, 113, 0.1));
            border: 2px solid rgba(39, 174, 96, 0.4);
        }

        .financial-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 15px;
            line-height: 1.6;
        }

        .financial-item:last-child {
            border-bottom: none;
        }

        .financial-label {
            color: var(--text-secondary);
            font-weight: 600;
        }

        .financial-value {
            font-weight: 700;
            font-size: 16px;
        }

        .financial-value.cost { color: var(--accent-blue); }
        .financial-value.savings { color: var(--accent-green); }
        .financial-value.roi { color: var(--accent-orange); }

        /* Notification System */
        .notification {
            position: fixed;
            top: 40px;
            right: 40px;
            background: linear-gradient(135deg, var(--success), #2ecc71);
            color: white;
            padding: 25px 35px;
            border-radius: 18px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
            z-index: 1000;
            max-width: 450px;
            animation: slideInRight 0.6s cubic-bezier(0.23, 1, 0.32, 1);
            border-left: 6px solid #ffffff;
            font-weight: 600;
        }

        .notification.error { background: linear-gradient(135deg, var(--danger), #c0392b); }
        .notification.info { background: linear-gradient(135deg, var(--accent-blue), #2980b9); }
        .notification.warning { background: linear-gradient(135deg, var(--warning), #e67e22); }

        @keyframes slideInRight {
            from { transform: translateX(120%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Responsive Design */
        @media (max-width: 1600px) {
            .dashboard-grid { grid-template-columns: 1fr; }
            .charts-container { grid-template-columns: 1fr; }
        }

        @media (max-width: 768px) {
            .container { padding: 25px; }
            .header h1 { font-size: 2.8rem; }
            .header p { font-size: 1.2rem; }
            .control-buttons { grid-template-columns: 1fr; }
            .metrics-grid { grid-template-columns: 1fr; }
            .ai-metrics { grid-template-columns: 1fr; }
            .login-container { min-width: 340px; margin: 25px; padding: 40px; }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-logo"></div>
        <div class="loading-text">Enterprise UPS System</div>
        <div class="loading-progress">
            <div class="loading-progress-bar" id="loadingProgress"></div>
        </div>
        <div class="loading-status" id="loadingStatus">Initializing core systems...</div>
    </div>

    <!-- Login Portal -->
    <div class="login-overlay" id="loginOverlay">
        <div class="login-container">
            <h1 class="login-title">Enterprise Portal</h1>
            <p class="login-subtitle">Advanced UPS Management System</p>
            <form id="loginForm">
                <input type="text" class="login-input" id="username" placeholder="Username" required>
                <input type="password" class="login-input" id="password" placeholder="Password" required>
                <button type="submit" class="login-btn">Access Enterprise Dashboard</button>
            </form>
            <div class="login-error" id="loginError"></div>
            <div class="security-notice">
                <strong>Enterprise Security Notice:</strong> This system requires authenticated access to advanced UPS analytics and AI-driven optimization systems.<br>
                <strong>Demo Access:</strong> admin / enterprise2024
            </div>
        </div>
    </div>

    <!-- Main Enterprise Dashboard -->
    <div id="mainDashboard" style="display: none;">
        <div class="header">
            <h1>Enterprise UPS Management System</h1>
            <p>AI-Driven Power Analytics | Predictive Maintenance | Real-time Optimization</p>
        </div>
        
        <div class="container">
            <div class="dashboard-grid">
                <div class="main-panel">
                    <!-- Control Center -->
                    <div class="panel control-panel">
                        <h3 style="font-size: 28px; font-weight: 800; margin-bottom: 30px; color: var(--accent-green);">Mission Control Center</h3>
                        <div class="control-buttons">
                            <button class="btn btn-start" onclick="startSystem()">Start System</button>
                            <button class="btn btn-stop" onclick="stopSystem()">Emergency Stop</button>
                            <button class="btn btn-simulate" onclick="runSimulation()">Run Simulation</button>
                            <button class="btn btn-analyze" onclick="performAnalysis()">Deep Analysis</button>
                            <button class="btn btn-export" onclick="exportReport()">Export Report</button>
                            <button class="btn btn-ai" onclick="toggleAIMode()">AI Optimization</button>
                        </div>
                        <div class="status" id="systemStatus">
                            <div class="status-indicator"></div>
                            SYSTEM STATUS: ACTIVE - Enterprise AI Engine Running
                        </div>
                    </div>
                    
                    <!-- Performance Metrics -->
                    <div class="panel">
                        <h3 style="font-size: 28px; font-weight: 800; margin-bottom: 30px; color: var(--text-primary);">Real-time Performance Analytics</h3>
                        <div class="metrics-grid">
                            <div class="metric-card">
                                <div class="metric-title">Current Load</div>
                                <div class="metric-value" id="currentLoad">32,520.23 VA</div>
                                <div class="metric-subtitle">Volt-Amperes | Real-time</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-title">AI Efficiency</div>
                                <div class="metric-value" id="systemEfficiency">87.4%</div>
                                <div class="metric-subtitle">Neural optimization active</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-title">Energy Optimized</div>
                                <div class="metric-value" id="energySaved">234 kWh</div>
                                <div class="metric-subtitle">Total AI optimization gains</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-title">Cost Reduction</div>
                                <div class="metric-value" id="costSavings">R12,847</div>
                                <div class="metric-subtitle">Financial optimization (ZAR)</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-title">Battery Health</div>
                                <div class="metric-value" id="batteryHealth">91.2%</div>
                                <div class="metric-subtitle">Predictive maintenance</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-title">Power Quality</div>
                                <div class="metric-value" id="powerQuality">93.6%</div>
                                <div class="metric-subtitle">THD & stability analysis</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-title">Uptime</div>
                                <div class="metric-value" id="systemUptime">94.8%</div>
                                <div class="metric-subtitle">Enterprise reliability</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-title">Neural Score</div>
                                <div class="metric-value" id="neuralScore">89.7</div>
                                <div class="metric-subtitle">AI performance index</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Charts Container -->
                    <div class="charts-container">
                        <div class="chart-panel">
                            <div class="chart-title">LSTM Neural Network Predictions</div>
                            <div class="chart-subtitle">Deep Learning Load Forecasting with Confidence Intervals</div>
                            <div class="chart-container">
                                <canvas id="loadChart"></canvas>
                            </div>
                        </div>
                        <div class="chart-panel">
                            <div class="chart-title">PSO Efficiency Optimization</div>
                            <div class="chart-subtitle">Particle Swarm Optimization Results</div>
                            <div class="chart-container">
                                <canvas id="efficiencyChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Analysis Panel -->
                    <div class="charts-container">
                        <div class="chart-panel">
                            <div class="chart-title">Harmonic Distortion Analysis</div>
                            <div class="chart-subtitle">Real-time THD & Power Quality Assessment</div>
                            <div class="chart-container">
                                <canvas id="harmonicChart"></canvas>
                            </div>
                        </div>
                        <div class="chart-panel">
                            <div class="chart-title">Neural Network Architecture</div>
                            <div class="chart-subtitle">Live AI Model Visualization</div>
                            <div class="chart-container">
                                <canvas id="neuralChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="side-panel">
                    <!-- AI Engine Panel -->
                    <div class="panel ai-panel">
                        <div class="ai-title">Enterprise AI Engine</div>
                        <div class="ai-metrics">
                            <div class="ai-metric">
                                <div class="ai-metric-label">Neural Accuracy</div>
                                <div class="ai-metric-value" id="modelAccuracy">92.4%</div>
                            </div>
                            <div class="ai-metric">
                                <div class="ai-metric-label">Prediction Confidence</div>
                                <div class="ai-metric-value" id="predictionConfidence">87.8%</div>
                            </div>
                            <div class="ai-metric">
                                <div class="ai-metric-label">Learning Rate</div>
                                <div class="ai-metric-value" id="learningRateDisplay">0.001</div>
                            </div>
                            <div class="ai-metric">
                                <div class="ai-metric-label">Training Samples</div>
                                <div class="ai-metric-value" id="trainingSamples">1.2M</div>
                            </div>
                            <div class="ai-metric">
                                <div class="ai-metric-label">Model Layers</div>
                                <div class="ai-metric-value" id="modelLayers">24</div>
                            </div>
                            <div class="ai-metric">
                                <div class="ai-metric-label">Processing Speed</div>
                                <div class="ai-metric-value" id="processingSpeed">543 Hz</div>
                            </div>
                        </div>
                        <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 20px; line-height: 1.8;">
                            <strong>Active Neural Networks:</strong><br>
                            LSTM Deep Learning | Transformer Architecture<br>
                            PSO Multi-Objective | Genetic Algorithm<br>
                            Fuzzy Logic Control | Reinforcement Learning<br>
                            Anomaly Detection | Pattern Recognition
                        </div>
                    </div>
                    
                    <!-- Financial Analysis -->
                    <div class="panel financial-panel">
                        <h3 style="font-size: 24px; font-weight: 800; margin-bottom: 25px; color: var(--accent-green);">Enterprise Financial Analysis</h3>
                        <div class="financial-item">
                            <span class="financial-label">Daily Energy Cost:</span>
                            <span class="financial-value cost" id="dailyCost">R1,847.36</span>
                        </div>
                        <div class="financial-item">
                            <span class="financial-label">Monthly Estimate:</span>
                            <span class="financial-value cost" id="monthlyCost">R55,420.80</span>
                        </div>
                        <div class="financial-item">
                            <span class="financial-label">Annual Projection:</span>
                            <span class="financial-value cost" id="annualCost">R673,286.40</span>
                        </div>
                        <div class="financial-item">
                            <span class="financial-label">AI Optimization Savings:</span>
                            <span class="financial-value savings" id="potentialSavings">R89,471.55</span>
                        </div>
                        <div class="financial-item">
                            <span class="financial-label">ROI Achievement:</span>
                            <span class="financial-value roi" id="roiPeriod">2.3 years</span>
                        </div>
                        <div class="financial-item">
                            <span class="financial-label">Carbon Footprint:</span>
                            <span class="financial-value" id="carbonFootprint" style="color: #58d68d;">524.7 kg CO₂</span>
                        </div>
                    </div>
                    
                    <!-- 3D System Topology -->
                    <div class="panel">
                        <h4 style="font-size: 22px; font-weight: 700; margin-bottom: 20px; color: var(--text-primary);">3D Enterprise Topology</h4>
                        <div class="topology-3d" id="topology3d"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global Configuration with Realistic Values
        const ENTERPRISE_CONFIG = {
            electricityRate: 2.47,
            systemRunning: false,
            aiMode: false,
            charts: {},
            scene: null,
            camera: null,
            renderer: null,
            upsComponents: {},
            animationId: null,
            timeSeriesData: {
                timestamps: [],
                loadData: [],
                efficiencyData: [],
                harmonicData: [],
                predictions: []
            },
            currentTime: 0,
            totalRuntime: 0
        };

        // Enhanced Error Handling
        function safeExecute(fn, fallback = null) {
            try {
                return fn();
            } catch (error) {
                console.warn('Function execution failed:', error);
                return fallback;
            }
        }

        // Loading System
        function initializeSystem() {
            const loadingSteps = [
                { text: 'Initializing core systems...', duration: 500 },
                { text: 'Loading neural networks...', duration: 800 },
                { text: 'Configuring optimization...', duration: 600 },
                { text: 'Establishing connections...', duration: 700 },
                { text: 'Calibrating sensors...', duration: 400 },
                { text: 'Activating AI modules...', duration: 900 },
                { text: 'System ready...', duration: 300 }
            ];

            let currentStep = 0;
            const progressBar = document.getElementById('loadingProgress');
            const statusText = document.getElementById('loadingStatus');

            function executeStep() {
                if (currentStep < loadingSteps.length) {
                    const step = loadingSteps[currentStep];
                    statusText.textContent = step.text;
                    progressBar.style.width = `${((currentStep + 1) / loadingSteps.length) * 100}%`;
                    
                    setTimeout(() => {
                        currentStep++;
                        executeStep();
                    }, step.duration);
                } else {
                    setTimeout(() => {
                        document.getElementById('loadingScreen').style.display = 'none';
                        document.getElementById('loginOverlay').style.display = 'flex';
                        generateRealisticData();
                    }, 1000);
                }
            }

            executeStep();
        }

        // Login System
        document.addEventListener('DOMContentLoaded', function() {
            initializeSystem();
            
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', function(event) {
                    event.preventDefault();
                    
                    const username = document.getElementById('username').value.trim();
                    const password = document.getElementById('password').value.trim();
                    
                    if (username === 'admin' && password === 'enterprise2024') {
                        document.getElementById('loginOverlay').style.display = 'none';
                        document.getElementById('mainDashboard').style.display = 'block';
                        showNotification('Enterprise System Activated - Welcome Administrator', 'success');
                        initializeDashboard();
                    } else {
                        document.getElementById('loginError').textContent = 'Access Denied - Invalid Enterprise Credentials';
                        showNotification('Authentication Failed - Security Protocol Activated', 'error');
                    }
                });
            }
        });

        // Generate Realistic Data with Proper Variations
        function generateRealisticData() {
            const now = Date.now();
            for (let i = 100; i >= 0; i--) {
                const timestamp = new Date(now - i * 60000);
                const hours = timestamp.getHours();
                
                // Realistic load patterns with proper business hours variation
                const baseLoad = 32000;
                const timeVariation = Math.sin((hours / 24) * 2 * Math.PI) * baseLoad * 0.25;
                const businessHours = (hours >= 7 && hours <= 19) ? 1.2 : 0.7;
                const randomVariation = (Math.random() - 0.5) * baseLoad * 0.15;
                const load = Math.max(15000, baseLoad * businessHours + timeVariation + randomVariation);
                
                // Realistic efficiency (75-95% range with occasional dips)
                const baseEfficiency = 82 + (Math.random() * 12); // 82-94% base range
                const timeEffect = Math.sin((hours / 24) * Math.PI) * 3; // Daily variation
                const loadEffect = (load / baseLoad - 1) * -5; // Efficiency drops with high load
                const efficiency = Math.max(75, Math.min(95, baseEfficiency + timeEffect + loadEffect));
                
                // Realistic harmonic distortion (2-8% range)
                const harmonic = 2.8 + Math.sin(i * 0.1) * 1.2 + Math.random() * 2;
                
                ENTERPRISE_CONFIG.timeSeriesData.timestamps.push(timestamp);
                ENTERPRISE_CONFIG.timeSeriesData.loadData.push(load);
                ENTERPRISE_CONFIG.timeSeriesData.efficiencyData.push(efficiency);
                ENTERPRISE_CONFIG.timeSeriesData.harmonicData.push(harmonic);
            }

            // Generate predictions
            generatePredictions();
        }

        // Generate AI Predictions
        function generatePredictions() {
            const lastLoad = ENTERPRISE_CONFIG.timeSeriesData.loadData[ENTERPRISE_CONFIG.timeSeriesData.loadData.length - 1];
            const avgLoad = ENTERPRISE_CONFIG.timeSeriesData.loadData.reduce((a, b) => a + b, 0) / ENTERPRISE_CONFIG.timeSeriesData.loadData.length;
            
            for (let i = 1; i <= 24; i++) { // 24-hour prediction
                const cyclicalPattern = Math.sin((i / 24) * 2 * Math.PI) * avgLoad * 0.2;
                const trendEffect = (lastLoad - avgLoad) * Math.exp(-i / 12); // Decay trend
                const randomNoise = (Math.random() - 0.5) * avgLoad * 0.1;
                const prediction = Math.max(15000, avgLoad + cyclicalPattern + trendEffect + randomNoise);
                
                ENTERPRISE_CONFIG.timeSeriesData.predictions.push(prediction);
            }
        }

        // Initialize Dashboard
        function initializeDashboard() {
            safeExecute(() => {
                initializeCharts();
                initialize3DTopology();
                startRealTimeSimulation();
            });
        }

        // Enhanced Chart Initialization
        function initializeCharts() {
            if (typeof Chart === 'undefined') {
                console.warn('Chart.js not available - using canvas fallbacks');
                initializeCanvasCharts();
                return;
            }

            try {
                Chart.defaults.font.family = "'Inter', 'Segoe UI', system-ui, sans-serif";
                Chart.defaults.font.size = 12;
                Chart.defaults.color = '#ecf0f1';

                // Load Prediction Chart with Real-time Updates
                const loadCtx = document.getElementById('loadChart');
                if (loadCtx) {
                    ENTERPRISE_CONFIG.charts.loadChart = new Chart(loadCtx.getContext('2d'), {
                        type: 'line',
                        data: {
                            labels: ENTERPRISE_CONFIG.timeSeriesData.timestamps.map(t => 
                                t.toLocaleTimeString('en-US', {hour: '2-digit', minute: '2-digit'})
                            ),
                            datasets: [{
                                label: 'Actual Load',
                                data: ENTERPRISE_CONFIG.timeSeriesData.loadData,
                                borderColor: '#5dade2',
                                backgroundColor: 'rgba(93, 173, 226, 0.1)',
                                fill: true,
                                tension: 0.4,
                                pointRadius: 2,
                                borderWidth: 3
                            }, {
                                label: 'LSTM Prediction',
                                data: [...Array(ENTERPRISE_CONFIG.timeSeriesData.loadData.length - 24).fill(null), 
                                      ...ENTERPRISE_CONFIG.timeSeriesData.predictions.slice(0, 24)],
                                borderColor: '#f093fb',
                                backgroundColor: 'rgba(240, 147, 251, 0.1)',
                                fill: false,
                                tension: 0.4,
                                pointRadius: 1,
                                borderWidth: 2,
                                borderDash: [5, 5]
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            animation: {
                                duration: 750,
                                easing: 'easeInOutQuart'
                            },
                            interaction: {
                                intersect: false,
                                mode: 'index'
                            },
                            plugins: {
                                legend: {
                                    labels: { 
                                        color: '#ecf0f1', 
                                        font: { weight: 'bold', size: 14 },
                                        usePointStyle: true
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: false,
                                    title: { 
                                        display: true, 
                                        text: 'Load (kW)', 
                                        color: '#ecf0f1', 
                                        font: { weight: 'bold', size: 16 } 
                                    },
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                    ticks: { 
                                        color: '#bdc3c7',
                                        callback: function(value) {
                                            return (value/1000).toFixed(1) + ' kW';
                                        }
                                    }
                                },
                                x: {
                                    title: { 
                                        display: true, 
                                        text: 'Time', 
                                        color: '#ecf0f1', 
                                        font: { weight: 'bold', size: 16 } 
                                    },
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                    ticks: { 
                                        color: '#bdc3c7',
                                        maxTicksLimit: 10
                                    }
                                }
                            }
                        }
                    });
                }

                // Efficiency Chart with Realistic Data
                const effCtx = document.getElementById('efficiencyChart');
                if (effCtx) {
                    ENTERPRISE_CONFIG.charts.efficiencyChart = new Chart(effCtx.getContext('2d'), {
                        type: 'line',
                        data: {
                            labels: ENTERPRISE_CONFIG.timeSeriesData.timestamps.map(t => 
                                t.toLocaleTimeString('en-US', {hour: '2-digit', minute: '2-digit'})
                            ),
                            datasets: [{
                                label: 'Current Efficiency',
                                data: ENTERPRISE_CONFIG.timeSeriesData.efficiencyData,
                                borderColor: '#58d68d',
                                backgroundColor: 'rgba(88, 214, 141, 0.2)',
                                fill: true,
                                tension: 0.4,
                                pointRadius: 2,
                                borderWidth: 3
                            }, {
                                label: 'Target Efficiency',
                                data: Array(ENTERPRISE_CONFIG.timeSeriesData.timestamps.length).fill(90),
                                borderColor: '#f7dc6f',
                                backgroundColor: 'transparent',
                                fill: false,
                                tension: 0,
                                pointRadius: 0,
                                borderWidth: 2,
                                borderDash: [5, 5]
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            animation: {
                                duration: 750,
                                easing: 'easeInOutQuart'
                            },
                            plugins: {
                                legend: {
                                    labels: { 
                                        color: '#ecf0f1', 
                                        font: { weight: 'bold', size: 14 }
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    min: 70, 
                                    max: 100,
                                    title: { 
                                        display: true, 
                                        text: 'Efficiency (%)', 
                                        color: '#ecf0f1', 
                                        font: { weight: 'bold', size: 16 } 
                                    },
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                    ticks: { 
                                        color: '#bdc3c7',
                                        callback: function(value) {
                                            return value.toFixed(1) + '%';
                                        }
                                    }
                                },
                                x: {
                                    title: { 
                                        display: true, 
                                        text: 'Time', 
                                        color: '#ecf0f1', 
                                        font: { weight: 'bold', size: 16 } 
                                    },
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                    ticks: { 
                                        color: '#bdc3c7',
                                        maxTicksLimit: 10
                                    }
                                }
                            }
                        }
                    });
                }

                // Harmonic Chart with Dynamic Data
                const harmonicCtx = document.getElementById('harmonicChart');
                if (harmonicCtx) {
                    ENTERPRISE_CONFIG.charts.harmonicChart = new Chart(harmonicCtx.getContext('2d'), {
                        type: 'bar',
                        data: {
                            labels: ['Fundamental', '3rd', '5th', '7th', '9th', '11th', '13th'],
                            datasets: [{
                                label: 'Harmonic Content (%)',
                                data: [100, 4.2, 3.1, 2.8, 1.9, 1.2, 0.8],
                                backgroundColor: [
                                    '#58d68d', '#f093fb', '#5dade2', '#f7dc6f', 
                                    '#bb8fce', '#ec7063', '#85c1e9'
                                ],
                                borderWidth: 2,
                                borderColor: 'rgba(255, 255, 255, 0.3)'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            animation: {
                                duration: 1000,
                                easing: 'easeInOutQuart'
                            },
                            plugins: {
                                legend: {
                                    labels: { 
                                        color: '#ecf0f1', 
                                        font: { weight: 'bold', size: 14 } 
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    title: { 
                                        display: true, 
                                        text: 'Magnitude (%)', 
                                        color: '#ecf0f1', 
                                        font: { weight: 'bold', size: 16 } 
                                    },
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                    ticks: { 
                                        color: '#bdc3c7',
                                        callback: function(value) {
                                            return value.toFixed(1) + '%';
                                        }
                                    }
                                },
                                x: {
                                    title: { 
                                        display: true, 
                                        text: 'Harmonic Order', 
                                        color: '#ecf0f1', 
                                        font: { weight: 'bold', size: 16 } 
                                    },
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                    ticks: { color: '#bdc3c7' }
                                }
                            }
                        }
                    });
                }

                // Neural Network Visualization
                initializeNeuralChart();

            } catch (error) {
                console.error('Chart.js initialization failed:', error);
                initializeCanvasCharts();
            }
        }

        // Neural Network Visualization Chart
        function initializeNeuralChart() {
            const neuralCanvas = document.getElementById('neuralChart');
            if (neuralCanvas) {
                const ctx = neuralCanvas.getContext('2d');
                
                function drawNeuralNetwork() {
                    const width = neuralCanvas.width = neuralCanvas.offsetWidth;
                    const height = neuralCanvas.height = neuralCanvas.offsetHeight;
                    
                    ctx.clearRect(0, 0, width, height);
                    
                    const layers = [8, 16, 12, 8, 1];
                    const layerWidth = width / (layers.length + 1);
                    const time = Date.now() * 0.002;
                    
                    // Draw connections with animated opacity
                    ctx.strokeStyle = 'rgba(93, 173, 226, 0.3)';
                    ctx.lineWidth = 1;
                    
                    for (let l = 0; l < layers.length - 1; l++) {
                        const currentLayerX = (l + 1) * layerWidth;
                        const nextLayerX = (l + 2) * layerWidth;
                        
                        for (let i = 0; i < Math.min(layers[l], 12); i++) {
                            for (let j = 0; j < Math.min(layers[l + 1], 12); j++) {
                                const y1 = (height / (Math.min(layers[l], 12) + 1)) * (i + 1);
                                const y2 = (height / (Math.min(layers[l + 1], 12) + 1)) * (j + 1);
                                
                                const opacity = 0.2 + 0.3 * Math.sin(time + l + i + j);
                                ctx.strokeStyle = `rgba(93, 173, 226, ${opacity})`;
                                
                                ctx.beginPath();
                                ctx.moveTo(currentLayerX, y1);
                                ctx.lineTo(nextLayerX, y2);
                                ctx.stroke();
                            }
                        }
                    }
                    
                    // Draw neurons with animated activation
                    for (let l = 0; l < layers.length; l++) {
                        const x = (l + 1) * layerWidth;
                        const neuronsToShow = Math.min(layers[l], 12);
                        
                        for (let i = 0; i < neuronsToShow; i++) {
                            const y = (height / (neuronsToShow + 1)) * (i + 1);
                            
                            // Animated activation
                            const activation = 0.3 + 0.7 * Math.sin(time * 2 + l * 0.5 + i * 0.3);
                            const radius = 6 + activation * 4;
                            
                            ctx.fillStyle = `hsl(${200 + activation * 60}, 70%, ${40 + activation * 30}%)`;
                            ctx.beginPath();
                            ctx.arc(x, y, radius, 0, 2 * Math.PI);
                            ctx.fill();
                            
                            ctx.strokeStyle = '#ecf0f1';
                            ctx.lineWidth = 2;
                            ctx.stroke();
                        }
                    }
                    
                    // Layer labels
                    ctx.fillStyle = '#ecf0f1';
                    ctx.font = '12px Inter';
                    ctx.textAlign = 'center';
                    const labels = ['Input', 'Hidden 1', 'Hidden 2', 'Hidden 3', 'Output'];
                    for (let l = 0; l < layers.length; l++) {
                        ctx.fillText(labels[l], (l + 1) * layerWidth, height - 10);
                    }
                }

                // Animate neural network
                function animateNeuralNetwork() {
                    drawNeuralNetwork();
                    if (ENTERPRISE_CONFIG.systemRunning) {
                        requestAnimationFrame(animateNeuralNetwork);
                    }
                }

                animateNeuralNetwork();
            }
        }

        // Enhanced 3D Topology with Advanced Features
        function initialize3DTopology() {
            const container = document.getElementById('topology3d');
            if (!container) return;

            if (typeof THREE === 'undefined') {
                console.warn('Three.js not available - using 2D fallback');
                init2DTopologyFallback(container);
                return;
            }

            try {
                container.innerHTML = '';

                // Scene setup
                ENTERPRISE_CONFIG.scene = new THREE.Scene();
                ENTERPRISE_CONFIG.scene.background = new THREE.Color(0x0a0a1a);
                ENTERPRISE_CONFIG.scene.fog = new THREE.Fog(0x0a0a1a, 20, 100);

                // Camera setup
                ENTERPRISE_CONFIG.camera = new THREE.PerspectiveCamera(
                    75, 
                    container.clientWidth / container.clientHeight, 
                    0.1, 
                    1000
                );
                ENTERPRISE_CONFIG.camera.position.set(15, 10, 15);

                // Renderer setup
                ENTERPRISE_CONFIG.renderer = new THREE.WebGLRenderer({ 
                    antialias: true, 
                    alpha: true 
                });
                ENTERPRISE_CONFIG.renderer.setSize(container.clientWidth, container.clientHeight);
                ENTERPRISE_CONFIG.renderer.shadowMap.enabled = true;
                ENTERPRISE_CONFIG.renderer.shadowMap.type = THREE.PCFSoftShadowMap;
                container.appendChild(ENTERPRISE_CONFIG.renderer.domElement);

                // Enhanced lighting
                const ambientLight = new THREE.AmbientLight(0x404040, 0.4);
                ENTERPRISE_CONFIG.scene.add(ambientLight);

                const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
                directionalLight.position.set(-10, 10, 5);
                directionalLight.castShadow = true;
                ENTERPRISE_CONFIG.scene.add(directionalLight);

                // Multiple colored point lights
                const pointLight1 = new THREE.PointLight(0x667eea, 0.8, 30);
                pointLight1.position.set(5, 5, 5);
                ENTERPRISE_CONFIG.scene.add(pointLight1);

                const pointLight2 = new THREE.PointLight(0xf093fb, 0.6, 20);
                pointLight2.position.set(-5, 3, -5);
                ENTERPRISE_CONFIG.scene.add(pointLight2);

                // Create advanced UPS system
                createAdvancedUPSSystem();
                createDataCenterEnvironment();
                createEnergyFlowVisualization();

                // Animation loop
                function animate() {
                    ENTERPRISE_CONFIG.animationId = requestAnimationFrame(animate);
                    
                    animateUPSComponents();
                    updateEnergyFlow();
                    
                    ENTERPRISE_CONFIG.renderer.render(ENTERPRISE_CONFIG.scene, ENTERPRISE_CONFIG.camera);
                }
                animate();

                // Handle resize
                window.addEventListener('resize', () => {
                    const width = container.clientWidth;
                    const height = container.clientHeight;
                    ENTERPRISE_CONFIG.camera.aspect = width / height;
                    ENTERPRISE_CONFIG.camera.updateProjectionMatrix();
                    ENTERPRISE_CONFIG.renderer.setSize(width, height);
                });

            } catch (error) {
                console.error('3D initialization failed:', error);
                init2DTopologyFallback(container);
            }
        }

        // Create Advanced UPS System
        function createAdvancedUPSSystem() {
            const upsGroup = new THREE.Group();
            
            // Main UPS chassis
            const chassisGeometry = new THREE.BoxGeometry(6, 3, 2);
            const chassisMaterial = new THREE.MeshPhongMaterial({
                color: 0x2c3e50,
                shininess: 100
            });
            const chassis = new THREE.Mesh(chassisGeometry, chassisMaterial);
            chassis.position.set(0, 1.5, 0);
            chassis.castShadow = true;
            chassis.receiveShadow = true;
            upsGroup.add(chassis);

            // Control panel
            const panelGeometry = new THREE.BoxGeometry(1.5, 1, 0.1);
            const panelMaterial = new THREE.MeshPhongMaterial({
                color: 0x34495e,
                transparent: true,
                opacity: 0.9
            });
            const controlPanel = new THREE.Mesh(panelGeometry, panelMaterial);
            controlPanel.position.set(0, 2, 1.05);
            upsGroup.add(controlPanel);

            // Status LEDs with glow effect
            const ledGeometry = new THREE.SphereGeometry(0.08);
            const ledColors = [0x27ae60, 0x27ae60, 0x3498db, 0xf39c12, 0xe74c3c];
            const ledPositions = [-0.4, -0.2, 0, 0.2, 0.4];

            ledPositions.forEach((pos, index) => {
                const ledMaterial = new THREE.MeshBasicMaterial({
                    color: ledColors[index],
                    emissive: ledColors[index],
                    emissiveIntensity: 0.6
                });
                const led = new THREE.Mesh(ledGeometry, ledMaterial);
                led.position.set(pos, 2.3, 1.1);
                upsGroup.add(led);
                ENTERPRISE_CONFIG.upsComponents[`led${index}`] = led;
            });

            // Cooling fans
            const fanGeometry = new THREE.CylinderGeometry(0.3, 0.3, 0.1, 8);
            const fanMaterial = new THREE.MeshPhongMaterial({ color: 0x7f8c8d });

            for (let i = 0; i < 2; i++) {
                const fan = new THREE.Mesh(fanGeometry, fanMaterial);
                fan.position.set(-1.5 + i * 3, 2.8, 0);
                fan.rotation.x = Math.PI / 2;
                upsGroup.add(fan);
                ENTERPRISE_CONFIG.upsComponents[`fan${i}`] = fan;
            }

            // Battery bank
            createBatteryBank(upsGroup);

            ENTERPRISE_CONFIG.scene.add(upsGroup);
            ENTERPRISE_CONFIG.upsComponents.mainGroup = upsGroup;
        }

        // Create Battery Bank
        function createBatteryBank(parentGroup) {
            const batteryGroup = new THREE.Group();
            const batteryGeometry = new THREE.BoxGeometry(0.8, 1.5, 0.6);
            const batteryMaterial = new THREE.MeshPhongMaterial({
                color: 0x27ae60,
                shininess: 80
            });

            for (let i = 0; i < 6; i++) {
                const battery = new THREE.Mesh(batteryGeometry, batteryMaterial);
                battery.position.set(-8 + i * 1.2, 0.75, -3);
                battery.castShadow = true;
                
                // Battery charge indicator
                const chargeGeometry = new THREE.BoxGeometry(0.6, 0.1, 0.4);
                const chargeMaterial = new THREE.MeshBasicMaterial({
                    color: 0x2ecc71,
                    emissive: 0x2ecc71,
                    emissiveIntensity: 0.3
                });
                const chargeIndicator = new THREE.Mesh(chargeGeometry, chargeMaterial);
                chargeIndicator.position.set(0, 0.8, 0);
                battery.add(chargeIndicator);
                
                batteryGroup.add(battery);
                ENTERPRISE_CONFIG.upsComponents[`battery${i}`] = battery;
            }

            parentGroup.add(batteryGroup);
        }

        // Create Data Center Environment
        function createDataCenterEnvironment() {
            // Floor
            const floorGeometry = new THREE.PlaneGeometry(40, 25);
            const floorMaterial = new THREE.MeshPhongMaterial({
                color: 0x34495e,
                shininess: 30
            });
            const floor = new THREE.Mesh(floorGeometry, floorMaterial);
            floor.rotation.x = -Math.PI / 2;
            floor.position.y = 0;
            floor.receiveShadow = true;
            ENTERPRISE_CONFIG.scene.add(floor);

            // Server racks with animated status lights
            for (let i = 0; i < 3; i++) {
                const rackGeometry = new THREE.BoxGeometry(0.8, 4, 1.5);
                const rackMaterial = new THREE.MeshPhongMaterial({ color: 0x2c3e50 });
                const rack = new THREE.Mesh(rackGeometry, rackMaterial);
                rack.position.set(10 + i * 2, 2, -6 + i * 3);
                rack.castShadow = true;
                
                // Add blinking status lights
                for (let j = 0; j < 8; j++) {
                    const lightGeometry = new THREE.SphereGeometry(0.02);
                    const lightMaterial = new THREE.MeshBasicMaterial({
                        color: Math.random() > 0.5 ? 0x27ae60 : 0x3498db,
                        emissive: Math.random() > 0.5 ? 0x27ae60 : 0x3498db,
                        emissiveIntensity: 0.8
                    });
                    const light = new THREE.Mesh(lightGeometry, lightMaterial);
                    light.position.set(0.35, -1.5 + j * 0.4, 0.7);
                    rack.add(light);
                }
                
                ENTERPRISE_CONFIG.scene.add(rack);
            }
        }

        // Create Energy Flow Visualization
        function createEnergyFlowVisualization() {
            ENTERPRISE_CONFIG.energyParticles = [];
            
            for (let i = 0; i < 15; i++) {
                const particleGeometry = new THREE.SphereGeometry(0.05);
                const particleMaterial = new THREE.MeshBasicMaterial({
                    color: 0x58d68d,
                    emissive: 0x58d68d,
                    emissiveIntensity: 0.8
                });
                const particle = new THREE.Mesh(particleGeometry, particleMaterial);
                
                ENTERPRISE_CONFIG.energyParticles.push({
                    mesh: particle,
                    progress: Math.random(),
                    speed: 0.005 + Math.random() * 0.01
                });
                
                ENTERPRISE_CONFIG.scene.add(particle);
            }
        }

        // Animate UPS Components
        function animateUPSComponents() {
            const time = Date.now() * 0.001;

            if (ENTERPRISE_CONFIG.upsComponents.mainGroup && ENTERPRISE_CONFIG.systemRunning) {
                // Gentle rotation
                ENTERPRISE_CONFIG.upsComponents.mainGroup.rotation.y = Math.sin(time * 0.2) * 0.05;

                // Animate fans
                for (let i = 0; i < 2; i++) {
                    if (ENTERPRISE_CONFIG.upsComponents[`fan${i}`]) {
                        ENTERPRISE_CONFIG.upsComponents[`fan${i}`].rotation.z += 0.3;
                    }
                }

                // Pulsing LEDs with realistic patterns
                for (let i = 0; i < 5; i++) {
                    if (ENTERPRISE_CONFIG.upsComponents[`led${i}`]) {
                        const intensity = 0.4 + 0.6 * Math.sin(time * 3 + i * 1.2);
                        ENTERPRISE_CONFIG.upsComponents[`led${i}`].material.emissiveIntensity = intensity;
                    }
                }

                // Battery charge animation
                for (let i = 0; i < 6; i++) {
                    if (ENTERPRISE_CONFIG.upsComponents[`battery${i}`]) {
                        const chargeLevel = 0.7 + 0.3 * Math.sin(time * 0.8 + i * 0.5);
                        ENTERPRISE_CONFIG.upsComponents[`battery${i}`].scale.y = chargeLevel;
                    }
                }
            }
        }

        // Update Energy Flow
        function updateEnergyFlow() {
            if (ENTERPRISE_CONFIG.energyParticles && ENTERPRISE_CONFIG.systemRunning) {
                ENTERPRISE_CONFIG.energyParticles.forEach(particle => {
                    particle.progress += particle.speed;
                    if (particle.progress > 1) particle.progress = 0;
                    
                    // Energy flow path from input to UPS to output
                    const t = particle.progress;
                    const x = -15 + t * 30;
                    const y = 2 + Math.sin(t * Math.PI * 2) * 0.5;
                    const z = Math.sin(t * Math.PI * 4) * 1;
                    
                    particle.mesh.position.set(x, y, z);
                });
            }
        }

        // 2D Topology Fallback
        function init2DTopologyFallback(container) {
            container.innerHTML = `<canvas id="topology2d" style="width: 100%; height: 100%;"></canvas>`;
            const canvas = document.getElementById('topology2d');
            const ctx = canvas.getContext('2d');
            canvas.width = container.offsetWidth;
            canvas.height = container.offsetHeight;

            function draw2DSystem() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                const centerX = canvas.width / 2;
                const centerY = canvas.height / 2;
                const time = Date.now() * 0.003;

                // Draw UPS main unit
                ctx.fillStyle = '#2c3e50';
                ctx.fillRect(centerX - 60, centerY - 40, 120, 80);
                
                ctx.strokeStyle = '#34495e';
                ctx.lineWidth = 3;
                ctx.strokeRect(centerX - 60, centerY - 40, 120, 80);

                // UPS label
                ctx.fillStyle = '#ecf0f1';
                ctx.font = 'bold 16px Inter';
                ctx.textAlign = 'center';
                ctx.fillText('ENTERPRISE UPS', centerX, centerY + 5);

                // Animated status LEDs
                const ledColors = ['#27ae60', '#27ae60', '#3498db', '#f39c12', '#e74c3c'];
                for (let i = 0; i < 5; i++) {
                    const intensity = 0.5 + 0.3 * Math.sin(time + i * 0.5);
                    const x = centerX - 40 + i * 20;
                    const y = centerY - 60;

                    ctx.shadowColor = ledColors[i];
                    ctx.shadowBlur = 15 * intensity;
                    ctx.fillStyle = ledColors[i];
                    ctx.beginPath();
                    ctx.arc(x, y, 8, 0, 2 * Math.PI);
                    ctx.fill();
                    ctx.shadowBlur = 0;
                }

                // Animated battery bank
                for (let i = 0; i < 6; i++) {
                    const x = centerX - 60 + i * 20;
                    const y = centerY + 80;
                    const charge = 0.6 + 0.4 * Math.sin(time + i * 0.3);

                    ctx.fillStyle = '#27ae60';
                    ctx.fillRect(x - 5, y, 10, 30);
                    
                    ctx.fillStyle = '#2ecc71';
                    ctx.fillRect(x - 4, y + 30 - (28 * charge), 8, 28 * charge);
                }

                // Animated power flow
                const flowOffset = (time * 50) % 40;
                ctx.strokeStyle = '#58d68d';
                ctx.lineWidth = 3;
                ctx.setLineDash([8, 8]);
                ctx.lineDashOffset = -flowOffset;

                // Input and output lines
                ctx.beginPath();
                ctx.moveTo(50, centerY);
                ctx.lineTo(centerX - 60, centerY);
                ctx.stroke();

                ctx.beginPath();
                ctx.moveTo(centerX + 60, centerY);
                ctx.lineTo(canvas.width - 50, centerY);
                ctx.stroke();

                // Labels
                ctx.setLineDash([]);
                ctx.fillStyle = '#ecf0f1';
                ctx.font = '14px Inter';
                ctx.fillText('GRID INPUT', 100, centerY - 20);
                ctx.fillText('LOAD OUTPUT', canvas.width - 100, centerY - 20);
                ctx.fillText('BATTERY BANK', centerX, centerY + 140);

                // Real-time metrics overlay
                ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';
                ctx.fillRect(20, 20, 250, 120);
                
                ctx.fillStyle = '#ecf0f1';
                ctx.font = 'bold 14px Inter';
                ctx.textAlign = 'left';
                ctx.fillText('REAL-TIME METRICS', 30, 45);

                const metrics = [
                    `Load: ${document.getElementById('currentLoad')?.textContent || 'N/A'}`,
                    `Efficiency: ${document.getElementById('systemEfficiency')?.textContent || 'N/A'}`,
                    `Battery: ${document.getElementById('batteryHealth')?.textContent || 'N/A'}`,
                    `Power Quality: ${document.getElementById('powerQuality')?.textContent || 'N/A'}`
                ];

                ctx.font = '12px Inter';
                metrics.forEach((metric, index) => {
                    ctx.fillText(metric, 30, 70 + index * 18);
                });

                if (ENTERPRISE_CONFIG.systemRunning) {
                    requestAnimationFrame(draw2DSystem);
                }
            }

            draw2DSystem();
        }

        // Real-time Simulation with Realistic Variations
        function startRealTimeSimulation() {
            ENTERPRISE_CONFIG.systemRunning = true;
            
            setInterval(() => {
                if (ENTERPRISE_CONFIG.systemRunning) {
                    updateRealTimeData();
                    updateChartsData();
                    updateFinancialMetrics();
                    updateAIMetrics();
                }
            }, 2000); // Update every 2 seconds for smoother animation
        }

        function updateRealTimeData() {
            const now = new Date();
            const hours = now.getHours();
            const minutes = now.getMinutes();
            
            // Advanced load calculation with realistic business patterns
            const baseLoad = 32000;
            const timeVariation = Math.sin((hours / 24) * 2 * Math.PI) * baseLoad * 0.3;
            const businessHours = (hours >= 8 && hours <= 18) ? 1.3 : 0.8;
            const lunchDip = (hours === 12 || hours === 13) ? 0.85 : 1;
            const randomVariation = (Math.random() - 0.5) * baseLoad * 0.12;
            const currentLoad = Math.max(18000, baseLoad * businessHours * lunchDip + timeVariation + randomVariation);

            // Realistic efficiency with load-dependent variations
            const optimalLoadRange = (currentLoad / baseLoad >= 0.7 && currentLoad / baseLoad <= 0.9);
            const baseEfficiency = optimalLoadRange ? 88 : 82;
            const aiBoost = ENTERPRISE_CONFIG.aiMode ? 4.5 : 0;
            const loadEffect = Math.abs(currentLoad / baseLoad - 0.8) * -8; // Efficiency drops away from optimal load
            const randomNoise = (Math.random() - 0.5) * 3;
            const efficiency = Math.max(75, Math.min(95, baseEfficiency + aiBoost + loadEffect + randomNoise));

            // Other realistic metrics
            const batteryHealth = Math.max(82, 91.2 - (ENTERPRISE_CONFIG.totalRuntime * 0.00001) + (Math.random() - 0.5) * 1.5);
            const powerQuality = 88 + (Math.random() * 8) + (efficiency > 90 ? 3 : 0);
            const uptime = Math.max(92, 94.8 + (ENTERPRISE_CONFIG.totalRuntime * 0.00002) + (Math.random() - 0.5) * 0.5);
            const neuralScore = 78 + (efficiency - 75) * 0.8 + (Math.random() - 0.5) * 4;

            // Update displays with animated counting
            animateValueUpdate('currentLoad', `${currentLoad.toLocaleString()} VA`);
            animateValueUpdate('systemEfficiency', `${efficiency.toFixed(1)}%`);
            animateValueUpdate('batteryHealth', `${batteryHealth.toFixed(1)}%`);
            animateValueUpdate('powerQuality', `${powerQuality.toFixed(1)}%`);
            animateValueUpdate('systemUptime', `${uptime.toFixed(1)}%`);
            animateValueUpdate('neuralScore', neuralScore.toFixed(1));

            // Update time series data
            ENTERPRISE_CONFIG.timeSeriesData.timestamps.push(now);
            ENTERPRISE_CONFIG.timeSeriesData.loadData.push(currentLoad);
            ENTERPRISE_CONFIG.timeSeriesData.efficiencyData.push(efficiency);
            ENTERPRISE_CONFIG.timeSeriesData.harmonicData.push(3.2 + Math.sin(ENTERPRISE_CONFIG.currentTime * 0.1) * 1.2 + Math.random() * 1);

            // Keep only last 60 data points for smooth scrolling
            if (ENTERPRISE_CONFIG.timeSeriesData.timestamps.length > 60) {
                ENTERPRISE_CONFIG.timeSeriesData.timestamps.shift();
                ENTERPRISE_CONFIG.timeSeriesData.loadData.shift();
                ENTERPRISE_CONFIG.timeSeriesData.efficiencyData.shift();
                ENTERPRISE_CONFIG.timeSeriesData.harmonicData.shift();
            }

            ENTERPRISE_CONFIG.currentTime += 1;
            ENTERPRISE_CONFIG.totalRuntime += 2;
        }

        // Animate value updates for smooth transitions
        function animateValueUpdate(elementId, newValue) {
            const element = document.getElementById(elementId);
            if (element) {
                element.style.transition = 'all 0.8s cubic-bezier(0.23, 1, 0.32, 1)';
                element.style.transform = 'scale(1.05)';
                element.textContent = newValue;
                
                setTimeout(() => {
                    element.style.transform = 'scale(1)';
                }, 300);
            }
        }

        function updateChartsData() {
            if (typeof Chart !== 'undefined' && Object.keys(ENTERPRISE_CONFIG.charts).length > 0) {
                try {
                    // Update load chart with predictions
                    if (ENTERPRISE_CONFIG.charts.loadChart) {
                        ENTERPRISE_CONFIG.charts.loadChart.data.labels = ENTERPRISE_CONFIG.timeSeriesData.timestamps.map(t => 
                            t.toLocaleTimeString('en-US', {hour: '2-digit', minute: '2-digit'})
                        );
                        ENTERPRISE_CONFIG.charts.loadChart.data.datasets[0].data = [...ENTERPRISE_CONFIG.timeSeriesData.loadData];
                        
                        // Update predictions
                        const predictionStart = ENTERPRISE_CONFIG.timeSeriesData.loadData.length - 12;
                        const predictionData = [...Array(Math.max(0, predictionStart)).fill(null), 
                                             ...ENTERPRISE_CONFIG.timeSeriesData.predictions.slice(0, 12)];
                        ENTERPRISE_CONFIG.charts.loadChart.data.datasets[1].data = predictionData;
                        
                        ENTERPRISE_CONFIG.charts.loadChart.update('none');
                    }

                    // Update efficiency chart
                    if (ENTERPRISE_CONFIG.charts.efficiencyChart) {
                        ENTERPRISE_CONFIG.charts.efficiencyChart.data.labels = ENTERPRISE_CONFIG.timeSeriesData.timestamps.map(t => 
                            t.toLocaleTimeString('en-US', {hour: '2-digit', minute: '2-digit'})
                        );
                        ENTERPRISE_CONFIG.charts.efficiencyChart.data.datasets[0].data = [...ENTERPRISE_CONFIG.timeSeriesData.efficiencyData];
                        ENTERPRISE_CONFIG.charts.efficiencyChart.update('none');
                    }

                    // Update harmonic chart with dynamic data
                    if (ENTERPRISE_CONFIG.charts.harmonicChart) {
                        const harmonicData = [
                            100,
                            4.2 + Math.sin(ENTERPRISE_CONFIG.currentTime * 0.05) * 0.8,
                            3.1 + Math.sin(ENTERPRISE_CONFIG.currentTime * 0.03) * 0.6,
                            2.8 + Math.sin(ENTERPRISE_CONFIG.currentTime * 0.07) * 0.4,
                            1.9 + Math.sin(ENTERPRISE_CONFIG.currentTime * 0.04) * 0.3,
                            1.2 + Math.sin(ENTERPRISE_CONFIG.currentTime * 0.06) * 0.2,
                            0.8 + Math.sin(ENTERPRISE_CONFIG.currentTime * 0.02) * 0.1
                        ];
                        ENTERPRISE_CONFIG.charts.harmonicChart.data.datasets[0].data = harmonicData;
                        ENTERPRISE_CONFIG.charts.harmonicChart.update('none');
                    }

                } catch (error) {
                    console.warn('Chart update failed:', error);
                }
            }
        }

        function updateFinancialMetrics() {
            const currentLoad = ENTERPRISE_CONFIG.timeSeriesData.loadData[ENTERPRISE_CONFIG.timeSeriesData.loadData.length - 1] || 32000;
            const realPowerKW = (currentLoad * 0.85) / 1000; // Realistic power factor
            
            // Realistic financial calculations
            const dailyEnergy = realPowerKW * 24;
            const dailyCost = dailyEnergy * ENTERPRISE_CONFIG.electricityRate;
            const monthlyCost = dailyCost * 30;
            const annualCost = dailyCost * 365;
            const optimizationSavings = annualCost * (ENTERPRISE_CONFIG.aiMode ? 0.13 : 0.08);
            const roiYears = 150000 / optimizationSavings; // Realistic ROI calculation
            const carbonFootprint = dailyEnergy * 0.9 * 30; // kg CO2 per month

            // Update with realistic energy savings
            const energySaved = Math.min(500, 234 + (ENTERPRISE_CONFIG.totalRuntime * 0.02));
            const costSavings = energySaved * ENTERPRISE_CONFIG.electricityRate;
            
            animateValueUpdate('energySaved', `${energySaved.toFixed(0)} kWh`);
            animateValueUpdate('costSavings', `R${costSavings.toLocaleString()}`);
            animateValueUpdate('dailyCost', `R${dailyCost.toFixed(2)}`);
            animateValueUpdate('monthlyCost', `R${monthlyCost.toLocaleString()}`);
            animateValueUpdate('annualCost', `R${annualCost.toLocaleString()}`);
            animateValueUpdate('potentialSavings', `R${optimizationSavings.toLocaleString()}`);
            animateValueUpdate('roiPeriod', `${roiYears.toFixed(1)} years`);
            animateValueUpdate('carbonFootprint', `${carbonFootprint.toFixed(1)} kg CO₂`);
        }

        function updateAIMetrics() {
            // Realistic AI metrics with variations
            const modelAccuracy = 89.4 + Math.sin(ENTERPRISE_CONFIG.currentTime * 0.02) * 3.0;
            const predictionConfidence = 84.8 + Math.sin(ENTERPRISE_CONFIG.currentTime * 0.03) * 4.0;
            const trainingSamples = 1.2 + (ENTERPRISE_CONFIG.totalRuntime / 50000);
            const processingSpeed = 543 + Math.sin(ENTERPRISE_CONFIG.currentTime * 0.05) * 120;
            
            animateValueUpdate('modelAccuracy', `${modelAccuracy.toFixed(1)}%`);
            animateValueUpdate('predictionConfidence', `${predictionConfidence.toFixed(1)}%`);
            animateValueUpdate('trainingSamples', `${trainingSamples.toFixed(1)}M`);
            animateValueUpdate('processingSpeed', `${processingSpeed.toFixed(0)} Hz`);
        }

        // Control Functions
        function startSystem() {
            ENTERPRISE_CONFIG.systemRunning = true;
            const statusEl = document.getElementById('systemStatus');
            if (statusEl) {
                statusEl.innerHTML = '<div class="status-indicator"></div>SYSTEM STATUS: ACTIVE - Enterprise AI Engine Running';
                statusEl.style.color = 'var(--accent-green)';
            }
            showNotification('Enterprise System Activated - Full AI Optimization Online', 'success');
            
            if (!ENTERPRISE_CONFIG.animationId) {
                startRealTimeSimulation();
            }
        }

        function stopSystem() {
            ENTERPRISE_CONFIG.systemRunning = false;
            const statusEl = document.getElementById('systemStatus');
            if (statusEl) {
                statusEl.innerHTML = '<div class="status-indicator" style="background: var(--danger); box-shadow: 0 0 25px var(--danger);"></div>SYSTEM STATUS: EMERGENCY STOP - All Operations Halted';
                statusEl.style.color = 'var(--danger)';
            }
            showNotification('Emergency Stop Activated - System Safely Shutdown', 'warning');
            
            if (ENTERPRISE_CONFIG.animationId) {
                cancelAnimationFrame(ENTERPRISE_CONFIG.animationId);
                ENTERPRISE_CONFIG.animationId = null;
            }
        }

        function toggleAIMode() {
            ENTERPRISE_CONFIG.aiMode = !ENTERPRISE_CONFIG.aiMode;
            const btn = event.target;
            
            if (btn) {
                if (ENTERPRISE_CONFIG.aiMode) {
                    btn.textContent = 'AI Optimization ON';
                    btn.style.background = 'linear-gradient(135deg, #27ae60, #2ecc71, #58d68d)';
                    showNotification('Neural Network Optimization Activated - Efficiency Boost Enabled', 'success');
                } else {
                    btn.textContent = 'AI Optimization';
                    btn.style.background = 'linear-gradient(135deg, #9b59b6, #8e44ad, #bb8fce)';
                    showNotification('AI Optimization Deactivated - Manual Mode Active', 'info');
                }
            }
        }

        function runSimulation() {
            showNotification('Monte Carlo Simulation Started - 10,000 Iterations', 'info');
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += Math.random() * 12 + 3;
                
                if (progress >= 100) {
                    clearInterval(interval);
                    showNotification('Simulation Complete - Efficiency Improvement: 8.7%, Cost Savings: R47,231', 'success');
                }
            }, 250);
        }

        function performAnalysis() {
            showNotification('Deep Learning Analysis Initiated - Processing Historical Data', 'info');
            
            setTimeout(() => {
                const efficiency = (Math.random() * 3 + 5).toFixed(1);
                const optimization = (Math.random() * 15 + 8).toFixed(1);
                showNotification(`Analysis Complete: ${efficiency}% efficiency improvement, ${optimization}% cost optimization potential`, 'success');
            }, 3000);
        }

        function exportReport() {
            try {
                const reportData = generateReportData();
                const reportText = generateReportText(reportData);
                
                const blob = new Blob([reportText], { type: 'text/plain;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `Enterprise_UPS_Report_${new Date().toISOString().slice(0,19).replace(/:/g,'-')}.txt`;
                a.style.display = 'none';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                showNotification('Enterprise Report Generated Successfully', 'success');
            } catch (error) {
                console.error('Export error:', error);
                showNotification('Report Export Failed - Check Console for Details', 'error');
            }
        }

        function generateReportData() {
            return {
                timestamp: new Date().toISOString(),
                systemStatus: ENTERPRISE_CONFIG.systemRunning ? 'Active' : 'Stopped',
                aiOptimization: ENTERPRISE_CONFIG.aiMode,
                currentMetrics: {
                    load: document.getElementById('currentLoad')?.textContent || 'N/A',
                    efficiency: document.getElementById('systemEfficiency')?.textContent || 'N/A',
                    batteryHealth: document.getElementById('batteryHealth')?.textContent || 'N/A',
                    uptime: document.getElementById('systemUptime')?.textContent || 'N/A',
                    powerQuality: document.getElementById('powerQuality')?.textContent || 'N/A',
                    neuralScore: document.getElementById('neuralScore')?.textContent || 'N/A'
                },
                financialData: {
                    dailyCost: document.getElementById('dailyCost')?.textContent || 'N/A',
                    annualCost: document.getElementById('annualCost')?.textContent || 'N/A',
                    potentialSavings: document.getElementById('potentialSavings')?.textContent || 'N/A',
                    energySaved: document.getElementById('energySaved')?.textContent || 'N/A'
                },
                aiMetrics: {
                    modelAccuracy: document.getElementById('modelAccuracy')?.textContent || 'N/A',
                    predictionConfidence: document.getElementById('predictionConfidence')?.textContent || 'N/A',
                    trainingSamples: document.getElementById('trainingSamples')?.textContent || 'N/A',
                    processingSpeed: document.getElementById('processingSpeed')?.textContent || 'N/A'
                }
            };
        }

        function generateReportText(data) {
            return `
ENTERPRISE UPS MANAGEMENT SYSTEM - COMPREHENSIVE REPORT
Generated: ${new Date().toLocaleString()}
================================================================

EXECUTIVE SUMMARY
System Status: ${data.systemStatus}
AI Optimization: ${data.aiOptimization ? 'ACTIVE' : 'STANDBY'}
Overall Performance: ${data.currentMetrics.efficiency} Efficiency | ${data.currentMetrics.uptime} Uptime

CURRENT PERFORMANCE METRICS
Current Load: ${data.currentMetrics.load}